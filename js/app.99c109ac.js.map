{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/App.vue?55b2","webpack:///./src/LineCollection.js","webpack:///./src/Turtle.js","webpack:///./src/LSystem.js","webpack:///./src/createScene.js","webpack:///./src/grammar/parser.js","webpack:///./src/getCodeModel.js","webpack:///./src/CodeEditor.vue?34d9","webpack:///./src/bus.js","webpack:///src/CodeEditor.vue","webpack:///./src/CodeEditor.vue?3cc2","webpack:///./src/CodeEditor.vue","webpack:///src/App.vue","webpack:///./src/App.vue?1160","webpack:///./src/App.vue","webpack:///./src/NoWebGL.vue?92cd","webpack:///./src/NoWebGL.vue","webpack:///./src/main.js","webpack:///./src/App.vue?995e","webpack:///./src/NoWebGL.vue?8160","webpack:///./src/lmode.js"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","_vm","this","_h","$createElement","_c","_self","attrs","staticClass","on","$event","preventDefault","toggleEdit","_v","_s","showEdit","randomize","class","syntaxHelpVisible","_m","_e","codeEditorModel","toSVGFile","staticRenderFns","LineCollection","gl","options","program","defineProgram","vertex","fragment","attributes","color","ColorAttribute","instanced","point","InstancedAttribute","width","_","drawContext","uniforms","modelViewProjection","resolution","height","draw","cb","count","getCount","from","x","y","z","to","GLCollection","Turtle","scene","position","checkArray","direction","normalize","lines","getGL","capacity","appendChild","stack","state","pop","removeChild","distance","add","renderFrame","angleInDegrees","rad","Math","PI","cos","sin","arrayName","array","Array","isArray","Error","arr","hypot","LSystem","systemSettings","coerceTypes","rules","actions","compileActions","turtle","stepsPerFrame","depth","Number","isFinite","start","undefined","keys","iterator","curve","dispose","next","steps","done","order","rule","op","rewriteRule","lSystem","defaultRotationAngle","angle","mergedActions","args","forEach","turtleAction","turtleCanDo","command","indexOf","rotateX","rotateY","rotateZ","getLength","move","system","parseFloat","rgba","tinycolor","toRgb","g","b","a","createLScene","canvas","createScene","guide","createGuide","lineColor","setClearColor","initialSceneSize","setViewBox","left","top","right","bottom","canDrawMore","raf","requestAnimationFrame","frame","setSystem","saveToSVG","fileName","svg","toSVG","open","blob","Blob","type","url","URL","createObjectURL","setTimeout","document","createElement","href","download","click","revokeLater","revokeObjectURL","newSystem","cancelAnimationFrame","wantGuideToBeHidden","hideGrid","drawSystem","separator","ws","numericKey","vectorKey","parens","ExpectRewriteValue","addTo","parent","valueParser","line","split","trim","process","v","join","replace","extractAction","stringValue","match","map","ExpectKeyValue","parseVector","vectorName","component","parse","str","currentState","lineNumber","startsWith","e","message","queryState","require","qs","code","getInitialCode","useSearch","standardCollection","getCodeModel","model","setCode","error","lastPickedIndex","index","pickRandomIndex","ignoreNextUpdate","newCode","parseExpression","axiom","set","floor","random","ref","viewportMargin","Infinity","theme","callback","$$v","$set","expression","bus","eventify","CodeMirror","toggleComment","cm","indent","lineComment","handleUp","updateValueIfNeededBy","handleDown","delta","token","Pass","ch","doc","getDoc","replaceRange","String","end","props","components","codemirror","mounted","$refs","editor","setOption","beforeDestroy","watch","pendingSetCode","clearTimeout","isImmediate","clearImmediate","methods","setImmediateUpdate","refreshEditor","isCollapsed","CodeEditor","script","Vue","config","productionTip","canRender","isWebGLEnabled","querySelector","render","h","App","NoWebGL","$mount","defineMode","parserConfig","content","indentUnit","statementIndent","jsonMode","json","isTS","lsystem","typescript","wordRE","wordCharacters","ruleCharRE","keywords","kw","style","nope","test","isOperatorChar","readRegexp","stream","escaped","inSet","ret","tp","cont","tokenBase","tokenize","tokenString","eat","tokenComment","skipToEnd","expressionAllowed","current","tokenQuasi","peek","eatWhile","lexical","word","lastType","propertyIsEnumerable","arrow","string","quote","maybeEnd","brackets","findFatArrow","fatArrowAt","exec","sawSomething","pos","charAt","bracket","atomicTypes","JSLexical","indented","column","align","prev","info","inScope","varname","localVars","cx","context","vars","parseJS","cc","marked","combinator","statement","lex","pass","arguments","inList","list","register","block","newContext","registerVarScoped","Var","globalVars","inner","Context","isModifier","defaultVars","pushcontext","pushblockcontext","popcontext","pushlex","outer","poplex","expect","wanted","exp","vardef","parenExpr","maybeexpression","maybeelse","functiondef","forspec","className","enumdef","typename","typeexpr","pattern","maybelabel","maybeCatchBinding","afterExport","afterImport","funarg","expressionInner","expressionNoComma","noComma","body","arrowBodyNoComma","arrowBody","commasep","maybeop","maybeoperatorNoComma","maybeoperatorComma","classExpression","arrayLiteral","contCommasep","objprop","quasi","maybeTarget","me","expr","backUp","continueQuasi","targetNoComma","target","maybeTypeArgs","getterSetter","afterprop","maybetype","what","sep","proceed","maybetypeOrIn","mayberettype","isKW","afterType","typeprop","typearg","maybeReturnType","functiondecl","typeparam","maybeTypeDefault","maybeAssign","vardefCont","eltpattern","proppattern","_type","forspec1","forspec2","classNameAfter","classBody","classfield","isInterface","maybeFrom","exportField","importSpec","maybeMoreImports","maybeAs","enummember","isContinuedStatement","textAfter","startState","basecolumn","sol","indentation","eatSpace","firstChar","closing","doubleIndentSwitch","electricInput","blockCommentStart","blockCommentEnd","blockCommentContinue","fold","closeBrackets","helperType","jsonldMode","skipExpression","registerHelper","defineMIME","jsonld"],"mappings":"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","file":"js/app.99c109ac.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[_c('div',{staticClass:\"sidebar\"},[_c('div',{staticClass:\"controls\"},[_c('a',{staticClass:\"print-button\",attrs:{\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();return _vm.toggleEdit($event)}}},[_vm._v(_vm._s(_vm.showEdit ? \"Hide editor\" : \"Edit...\"))]),_c('a',{staticClass:\"try-another\",attrs:{\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();return _vm.randomize($event)}}},[_vm._v(\"Randomize\")])]),(_vm.showEdit)?_c('div',{staticClass:\"editor-container\"},[_c('div',{staticClass:\"section\"},[_c('div',{staticClass:\"title\"},[_vm._v(\"L-System details: \"),_c('a',{staticClass:\"reset-all\",class:{\"syntax-visible\": _vm.syntaxHelpVisible},attrs:{\"href\":\"#\",\"title\":\"click to learn more about syntax\"},on:{\"click\":function($event){$event.preventDefault();_vm.syntaxHelpVisible = !_vm.syntaxHelpVisible}}},[_vm._v(\"syntax help\")])]),(_vm.syntaxHelpVisible)?_c('div',{staticClass:\"help\"},[_vm._v(\" L-Systems are described very well on \"),_c('a',{attrs:{\"href\":\"http://paulbourke.net/fractals/lsys/\",\"target\":\"_blank\"}},[_vm._v(\"Paul Bourke's website\")]),_vm._v(\". \"),_vm._m(0)]):_vm._e(),(_vm.codeEditorModel)?_c('code-editor',{staticClass:\"code-editor-container\",attrs:{\"model\":_vm.codeEditorModel}}):_vm._e()],1),_c('div',{staticClass:\"section border-top\"},[_vm._m(1),_vm._m(2),_c('p',[_vm._v(\"Finally, you can \"),_c('a',{attrs:{\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();return _vm.toSVGFile($event)}}},[_vm._v(\"export to svg\")]),_vm._v(\" current scene\")])])]):_vm._e()])])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('p',[_vm._v(\"The following is the list of available sections: \"),_c('ul',[_c('li',[_c('strong',[_vm._v(\"axiom\")]),_vm._v(\": initial state of the system\")]),_c('li',[_c('strong',[_vm._v(\"rules\")]),_vm._v(\": list of rewrite rules that are applied on each iteration\")]),_c('li',[_c('strong',[_vm._v(\"depth\")]),_vm._v(\": how deep we are allowed to go recursively\")]),_c('li',[_c('strong',[_vm._v(\"angle\")]),_vm._v(\": if specified, this argument governs rotation angle. Can be overridden with \"),_c('strong',[_vm._v(\"actions\")])]),_c('li',[_c('strong',[_vm._v(\"actions\")]),_vm._v(\": list of graphic commands that are triggered by a matching character in the evolved system. The following is the list of available actions: \"),_c('ul',[_c('li',[_c('strong',[_vm._v(\"draw(x)\")]),_vm._v(\" draw \"),_c('code',[_vm._v(\"x\")]),_vm._v(\" units in current direction\")]),_c('li',[_c('strong',[_vm._v(\"move(x)\")]),_vm._v(\" move \"),_c('code',[_vm._v(\"x\")]),_vm._v(\" units in current direction without drawing\")]),_c('li',[_c('strong',[_vm._v(\"rotate(deg)\")]),_vm._v(\" rotate current direction \"),_c('code',[_vm._v(\"deg\")]),_vm._v(\" degrees around Z axis\")]),_c('li',[_c('strong',[_vm._v(\"rotateX(deg)\")]),_vm._v(\" rotate current direction \"),_c('code',[_vm._v(\"deg\")]),_vm._v(\" degrees around X axis\")]),_c('li',[_c('strong',[_vm._v(\"rotateY(deg)\")]),_vm._v(\" rotate current direction \"),_c('code',[_vm._v(\"deg\")]),_vm._v(\" degrees around Y axis\")]),_c('li',[_c('strong',[_vm._v(\"push()\")]),_vm._v(\" saves current render state onto stack\")]),_c('li',[_c('strong',[_vm._v(\"pop()\")]),_vm._v(\" restores previously saved render state\")])]),_vm._v(\" By default the following actions are added automatically: \"),_c('pre',[_c('code',[_vm._v(\"actions:\\n  F => draw(10)\\n  f => move(10)\\n  + => rotate(60)\\n  - => rotate(-60)\\n  [ => push()\\n  ] => pop()\\n\")])])]),_c('li',[_c('strong',[_vm._v(\"width\")]),_vm._v(\": width in pixels of the drawn line\")]),_c('li',[_c('strong',[_vm._v(\"color\")]),_vm._v(\": color of the line. Accepts names and hex. E.g. \"),_c('code',[_vm._v(\"blue\")]),_vm._v(\", works the same as \"),_c('code',[_vm._v(\"#0000ff\")])]),_c('li',[_c('strong',[_vm._v(\"stepsPerFrame\")]),_vm._v(\": how many steps we are allowed to render per single frame. If set to \"),_c('code',[_vm._v(\"-1\")]),_vm._v(\" the scene is rendered immediately. This could be dangerous on deep systems, as the entire system traversal may exhaust the browser's resources. \")]),_c('li',[_c('strong',[_vm._v(\"direction\")]),_vm._v(\": three numbers separated by coma \"),_c('code',[_vm._v(\"x, y, z\")]),_vm._v(\" that set initial direction\")]),_c('li',[_c('strong',[_vm._v(\"position\")]),_vm._v(\": three numbers separated by coma \"),_c('code',[_vm._v(\"x, y, z\")]),_vm._v(\" that set initial position\")])])])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('p',[_vm._v(\"This website renders any L-Systems defined above. The website was created by \"),_c('a',{attrs:{\"href\":\"https://twitter.com/anvaka\"}},[_vm._v(\"@anvaka\")]),_vm._v(\".\")])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('p',[_vm._v(\"You can find the entire source code \"),_c('a',{attrs:{\"href\":\"https://github.com/anvaka/lsystem\"}},[_vm._v(\"here\")]),_vm._v(\". If you love this website you can also \"),_c('a',{attrs:{\"href\":\"https://www.paypal.com/paypalme2/anvakos/3\"}},[_vm._v(\"buy me a coffee\")])])}]\n\nexport { render, staticRenderFns }","import {GLCollection, defineProgram, InstancedAttribute, ColorAttribute} from 'w-gl';\n\nexport default class LineCollection extends GLCollection {\n  constructor(gl, options = {}) {\n    let program = defineProgram({\n      gl,\n      vertex: `\n    uniform mat4 modelViewProjection;\n    uniform float width;\n    uniform vec2 resolution;\n\n    attribute vec4 color;\n    attribute vec3 from, to;\n    attribute vec2 point;\n\n    varying vec4 vColor;\n    varying vec2 vPoint;\n\n    void main() {\n      vec4 clip0 = modelViewProjection * vec4(from, 1.0);\n      vec4 clip1 = modelViewProjection * vec4(to, 1.0);\n\n      vec2 screen0 = resolution * (0.5 * clip0.xy/clip0.w + 0.5);\n      vec2 screen1 = resolution * (0.5 * clip1.xy/clip1.w + 0.5);\n\n      vec2 xBasis = normalize(screen1 - screen0);\n      vec2 yBasis = vec2(-xBasis.y, xBasis.x);\n\n      // Offset the original points:\n      vec2 pt0 = screen0 + width * point.x * yBasis;\n      vec2 pt1 = screen1 + width * point.x * yBasis;\n\n      vec2 pt = mix(pt0, pt1, point.y);\n      vec4 clip = mix(clip0, clip1, point.y);\n\n      gl_Position = vec4(clip.w * (2.0 * pt/resolution - 1.0), clip.z, clip.w);\n      vColor = color.abgr; // mix(.abgr, aToColor.abgr, aPosition.y);\n    }`,\n\n      fragment: `\n    precision highp float;\n    varying vec4 vColor;\n\n    void main() {\n      gl_FragColor = vColor;\n    }`,\n      attributes: {\n        color: new ColorAttribute()\n      },\n      instanced: {\n        point: new InstancedAttribute([\n          -0.5, 0, -0.5, 1, 0.5, 1, // First 2D triangle of the quad\n          -0.5, 0, 0.5, 1, 0.5, 0   // Second 2D triangle of the quad\n        ])\n      }\n    });\n    super(program);\n    this.width = options.width || 2;\n  }\n\n  draw(_, drawContext) {\n    if (!this.uniforms) {\n      this.uniforms = {\n        modelViewProjection: this.modelViewProjection,\n        width: this.width,\n        resolution: [drawContext.width, drawContext.height]\n      }\n    }\n    this.uniforms.resolution[0] = drawContext.width;\n    this.uniforms.resolution[1] = drawContext.height;\n    this.program.draw(this.uniforms);\n  }\n\n  // implement lineRenderTrait to allow SVG export via w-gl\n  forEachLine(cb) {\n    let count = this.program.getCount()\n    for (let i = 0; i < count; ++i) {\n      let vertex = this.program.get(i);\n      let from = { x: vertex.from[0], y: vertex.from[1], z: vertex.from[2], color: vertex.color }\n      let to = { x: vertex.to[0], y: vertex.to[1], z: vertex.to[2], color: vertex.color }\n      cb(from, to);\n    }\n  }\n\n  getLineColor(from) {\n    let count = this.program.getCount()\n    let c = from ? \n              from.color :  \n              count > 0 ? this.program.get(0).color : 0xFFFFFFFF;\n\n    return [\n      (c >> 24) & 0xFF / 255,\n      (c >> 16) & 0xFF / 255,\n      (c >>  8) & 0xFF / 255,\n      (c >>  0) & 0xFF / 255,\n    ]\n  }\n}","import LineCollection from './LineCollection';\n\nexport default class Turtle {\n  constructor(scene, options = {}) {\n    this.position = options.position || [0, 0, 0];\n    checkArray('position', this.position);\n    this.direction = options.direction || [1, 0, 0];\n    normalize(this.direction);\n    checkArray('direction', this.direction);\n\n    this.lines = new LineCollection(scene.getGL(), { capacity: 1024, width: options.width || 2 });\n    this.scene = scene;\n    this.color = options.color || 0xFFFFFFFF;\n\n    this.scene.appendChild(this.lines);\n    this.stack = [];\n  }\n\n  push() {\n    this.stack.push({\n      color: this.color,\n      direction: [this.direction[0], this.direction[1], this.direction[2]],\n      position: [this.position[0], this.position[1], this.position[2]],\n    })\n  }\n\n  pop() {\n    let state = this.stack.pop();\n    this.color = state.color;\n    this.direction = state.direction;\n    this.position = state.position;\n  }\n\n  dispose() {\n    this.scene.removeChild(this.lines);\n  }\n\n  move(distance) {\n    let p = this.position;\n    let n = this.direction;\n    let x = p[0] + distance * n[0];\n    let y = p[1] + distance * n[1];\n    let z = p[2] + distance * n[2];\n    p[0] = x; p[1] = y; p[2] = z;\n  }\n\n  draw(distance) {\n    let p = this.position;\n    let n = this.direction;\n    let x = p[0] + distance * n[0];\n    let y = p[1] + distance * n[1];\n    let z = p[2] + distance * n[2];\n    this.lines.add({\n      from: p, \n      to: [x, y, z],\n      color: this.color\n    });\n\n    p[0] = x; p[1] = y; p[2] = z;\n    this.scene.renderFrame();\n  }\n\n  rotateZ(angleInDegrees) {\n    let rad = Math.PI * angleInDegrees / 180;\n    let n = this.direction;\n\n    let x = Math.cos(rad) * n[0] - Math.sin(rad) * n[1];\n    let y = Math.sin(rad) * n[0] + Math.cos(rad) * n[1];\n\n    n[0] = x;\n    n[1] = y;\n  }\n\n  rotateY(angleInDegrees) {\n    let rad = Math.PI * angleInDegrees / 180;\n    let n = this.direction;\n\n    let x = Math.cos(rad) * n[0] - Math.sin(rad) * n[2];\n    let z = Math.sin(rad) * n[0] + Math.cos(rad) * n[2];\n\n    n[0] = x;\n    n[2] = z;\n  }\n\n  rotateX(angleInDegrees) {\n    let rad = Math.PI * angleInDegrees / 180;\n    let n = this.direction;\n\n    let y = Math.cos(rad) * n[1] - Math.sin(rad) * n[2];\n    let z = Math.sin(rad) * n[1] + Math.cos(rad) * n[2];\n\n    n[1] = y;\n    n[2]= z;\n  }\n}\n\nfunction checkArray(arrayName, array, ) {\n  if (!Array.isArray(array)) {\n    throw new Error('Array is expected for `' + arrayName + '`');\n  }\n  if (array.length === 2) {\n    array.push(0);\n  }\n  if (array.length !== 3) {\n    throw new Error('Array `' + arrayName + '` should have 2 or 3 coordinates, got ' + array.length);\n  }\n}\nfunction normalize(arr) {\n  let l = Math.hypot(arr[0], arr[1], arr[2]);\n  arr[0] /= l;\n  arr[1] /= l;\n  arr[2] /= l;\n}","import Turtle from './Turtle';\nimport tinycolor from 'tinycolor2';\n\nexport default class LSystem {\n  constructor(scene, systemSettings) {\n    coerceTypes(systemSettings);\n    // this.rewrite = compileRules(systemSettings.rewrite, systemSettings.start, this);\n    this.rules = systemSettings.rules;\n    this.actions = compileActions(systemSettings, this);\n    this.turtle = new Turtle(scene, systemSettings);\n    this.stepsPerFrame = systemSettings.stepsPerFrame || 42;\n\n    const depth = Number.isFinite(systemSettings.depth) ? systemSettings.depth : 5;\n    let start = systemSettings.start;\n    if (start === undefined) start = Object.keys(this.rules)[0];\n    if (start === undefined) throw new Error('System does not have neither rewrite rules nor start state');\n    this.depth = depth + 1;\n    this.iterator = this.curve(this.depth, start);\n  }\n\n  dispose() {\n    this.turtle.dispose();\n  }\n\n  frame() {\n    let next, steps = 0;\n    do {\n      next = this.iterator.next();\n    } while (!next.done && steps++ < this.stepsPerFrame );\n    return !next.done;\n  }\n\n  *curve(order, rule) {\n    if (order === 0) {\n      // if (this.actions[action]) {\n      //   this.actions[action]();\n      // }\n      return;\n    }\n\n    // let level = [];\n    for (let op of rule) {\n      if (this.actions[op]) {\n        // level.push(op)\n        if (this.stepsPerFrame < 0) {\n          yield* this.actions[op](this.depth);\n        } else {\n          yield this.actions[op](this.depth);\n        }\n      }\n      let rewriteRule = this.rules[op];\n      if (!rewriteRule) continue;\n      yield* this.curve(order - 1, rewriteRule)\n    }\n    //console.log('level ' + order + ': ' + level.join(''))\n  }\n}\n\nfunction compileActions(systemSettings, lSystem) {\n  let actions = {};\n\n  let defaultRotationAngle = Number.isFinite(systemSettings.angle) ? systemSettings.angle : 60; \n\n  let mergedActions = {\n    'F': {name: 'draw', args: []},\n    'f': {name: 'move', args: []},\n    '+': {name: 'rotate', args: [defaultRotationAngle]},\n    '-': {name: 'rotate', args: [-defaultRotationAngle]},\n    '[': {name: 'push', args: []},\n    ']': {name: 'pop', args: []},\n    ...systemSettings.actions\n  }\n\n  Object.keys(mergedActions).forEach(key => {\n    let value = mergedActions[key];\n    let turtleAction = turtleCanDo(value, lSystem);\n    if (turtleAction) {\n      actions[key] = turtleAction;\n    } else {\n      throw new Error(\"Turtle does not know how to do '\" + value + \"'\");\n    }\n  });\n\n  return actions;\n}\n\nfunction turtleCanDo(command, lSystem) {\n  if (command.name.indexOf('rotate') === 0) {\n    let angle = command.args[0]\n    if (!Number.isFinite(angle)) throw new Error('`rotate() needs one float argument');\n\n    switch (command.name) {\n      case 'rotateX': return function() { lSystem.turtle.rotateX(angle) };\n      case 'rotateY': return function() { lSystem.turtle.rotateY(angle) };\n    }\n\n    return function() { lSystem.turtle.rotateZ(angle) };\n  }\n\n  if (command.name === 'draw') {\n    let length = getLength(command.args[0], 'draw');\n    return function() {\n      lSystem.turtle.draw(length)\n    }\n  }\n\n  if (command.name === 'push') return function() {lSystem.turtle.push()}\n  if (command.name === 'pop') return function() {lSystem.turtle.pop()}\n  if (command.name === 'move') {\n    let length = getLength(command.args[0], 'move');\n    return function() {lSystem.turtle.move(length)}\n  }\n}\n\n\nfunction getLength(value, name) {\n  let length = 10;\n  if (value !== undefined) {\n    length = value;\n    if (!Number.isFinite(length)) throw new Error(name  +'(l) expects `l` to be a float number. Got: ' + value);\n  }\n  return length;\n}\n\n\nfunction coerceTypes(system) {\n  if (system.angle !== undefined) system.angle = Number.parseFloat(system.angle);\n  if (system.width !== undefined) system.width = Number.parseFloat(system.width);\n  if (system.depth !== undefined) system.depth = Number.parseFloat(system.depth);\n  if (system.color !== undefined) {\n    let rgba = tinycolor(system.color).toRgb();\n    system.color = (rgba.r << 24) | (rgba.g << 16) | (rgba.b << 8) | (rgba.a * 255 | 0)\n  } \n}","import {createScene, createGuide, toSVG} from 'w-gl';\nimport LSystem from './LSystem';\n\nexport default function createLScene(canvas) {\n  let scene = createScene(canvas);\n  let guide = createGuide(scene, {\n    lineColor: 0x0d3f71ff\n  });\n\n  scene.setClearColor(12/255, 41/255, 82/255, 1)\n  let initialSceneSize = 40;\n  scene.setViewBox({\n    left:  -initialSceneSize,\n    top:   -initialSceneSize,\n    right:  initialSceneSize,\n    bottom: initialSceneSize,\n  });\n\n  let canDrawMore = false;\n  let lSystem = [];\n  let raf = requestAnimationFrame(frame);\n\n  return {\n    dispose,\n    setSystem,\n    saveToSVG\n  }\n\n  function saveToSVG(fileName) {\n    let svg = toSVG(scene, {\n      open() {\n        return `<!-- Generator: https://github.com/anvaka/l-system -->`;\n      }\n    });\n    let blob = new Blob([svg], {type: \"image/svg+xml\"});\n    let url = window.URL.createObjectURL(blob);\n    // For some reason, safari doesn't like when download happens on the same\n    // event loop cycle. Pushing it to the next one.\n    setTimeout(() => {\n      let a = document.createElement(\"a\");\n      a.href = url;\n      a.download = fileName;\n      a.click();\n      revokeLater(url);\n    }, 30)\n  }\n\n  function revokeLater(url) {\n    // In iOS immediately revoked URLs cause \"WebKitBlobResource error 1.\" error\n    // Setting a timeout to revoke URL in the future fixes the error:\n    setTimeout(() => {\n      window.URL.revokeObjectURL(url);\n    }, 45000);\n  }\n\n  function setSystem(newSystem) {\n    cancelAnimationFrame(raf);\n    lSystem.forEach(l => l.dispose());\n\n    if (!Array.isArray(newSystem)) {\n      newSystem = [newSystem]\n    }\n    let wantGuideToBeHidden = false;\n    lSystem = [];\n    newSystem.forEach(systemSettings => {\n      if (systemSettings.hideGrid) {\n        wantGuideToBeHidden = true;\n      }\n      lSystem.push(new LSystem(scene, systemSettings));\n    });\n\n    if (wantGuideToBeHidden && guide) {\n      guide.dispose();\n      guide = null;\n    } else if (!wantGuideToBeHidden && !guide) {\n      guide = createGuide(scene);\n    }\n\n    raf = requestAnimationFrame(frame);\n  }\n\n  function frame() {\n    canDrawMore = false;\n    lSystem.forEach(drawSystem);\n    if (canDrawMore) {\n      raf = requestAnimationFrame(frame);\n    }\n  }\n\n  function drawSystem(system) {\n    canDrawMore |= system.frame();\n  }\n\n  function dispose() {\n    cancelAnimationFrame(raf);\n    scene.dispose();\n  }\n}","const separator = /:|->|=>|=|→/\nconst rules = /rules|production rules/i;\nconst actions = /actions/i;\nconst ws = /[ \\t]/g;\nconst numericKey = /angle|depth|width|stepsPerFrame/i;\nconst vectorKey = /direction|position/i;\nconst parens = /[[\\]()]/;\n\nclass ExpectRewriteValue {\n  constructor(addTo, parent, valueParser) {\n    this.parent = parent;\n    this.addTo = addTo;\n    this.valueParser = valueParser || (result => result);\n  }\n\n  process(line) {\n    let result = line.split(separator)\n    if (result.length === 1) throw new Error('Expected `_ => value`, found ' + line);\n\n    let key = result[0].trim();\n    if (key.length !== 1) {\n      // we are done with this rule\n      return this.parent.process(line);\n    }\n    let v = result.slice(1).join('').replace(ws, '');\n    this.addTo[key] = this.valueParser(v);\n    return this;\n  }\n}\n\nfunction extractAction(stringValue) {\n  let m = stringValue.match(/(\\w+?)\\s*\\((.+?)?\\)/);\n  if (!m) {\n    throw new Error('Expected `action()` call, got: ' + stringValue);\n  }\n  let name = m[1];\n  let args = !m[2] ? [] : m[2].split(',').map(v => Number.parseFloat(v.trim()));\n  return {name, args};\n}\n\nclass ExpectKeyValue {\n  constructor(addTo) {\n    this.addTo = addTo;\n  }\n\n  process(line) {\n    let result = line.split(separator)\n    if (result.length === 1) throw new Error('Expected `key: value`, found ' + line);\n    let key = result[0].trim();\n    let value = result.slice(1).join('').trim();\n    if (key.match(rules)) {\n      this.addTo.rules = {};\n      return new ExpectRewriteValue(this.addTo.rules, this);\n    } else if (key.match(actions)) {\n      this.addTo.actions = {};\n      return new ExpectRewriteValue(this.addTo.actions, this, extractAction);\n    } else if (key.match(numericKey)) {\n      let v = Number.parseFloat(value);\n      if (!Number.isFinite(v)) {\n        throw new Error('Expected a number value for `' + key + '`');\n      }\n      this.addTo[key] = v;\n      return this;\n    } else if (key.match(vectorKey)) {\n      this.addTo[key] = parseVector(value, key)\n      return this;\n    }\n\n    this.addTo[key] = value;\n    return this;\n  }\n}\n\nfunction parseVector(v, vectorName) {\n  return v.replace(parens, '').replace(ws, '').split(',').map((component, position) => {\n    if (!component) {\n      throw new Error('Missing vector component at position ' + position +' for `' + vectorName + '`');\n    }\n    let x = Number.parseFloat(component);\n    if (!Number.isFinite(x)) {\n      throw new Error('Vectors are expected to be numbers. Found `' + component + '` in `' + v + '`');\n    }\n    return x;\n  })\n}\n\nexport default function parse(str) {\n  let lines = str.split('\\n');\n  let currentState = new ExpectKeyValue({});\n\n  lines.forEach((line, lineNumber) => {\n    line = line.trim();\n    // ignore comments and empty lines\n    if (line === '' || line.startsWith('//')) return;\n    try {\n      currentState = currentState.process(line);\n    } catch (e) {\n      throw new Error(e.message + '\\n\\n at line ' + lineNumber);\n    }\n  });\n\n  while (currentState.parent) {\n    currentState = currentState.parent;\n  }\n  return currentState.addTo;\n}\n","import parseExpression from './grammar/parser';\nconst queryState = require('query-state');\n\nvar qs = queryState({\n  code: getInitialCode()\n}, {\n  useSearch: true\n});\n\n// Create a Parser object from our grammar.\nlet standardCollection = [\n`// dragon curve\naxiom: X\nrules: \n X => X+YF+\n Y => -FX-Y\n\ndepth: 10\nangle: 90`,\n\n`// Hexagonal Gosper\naxiom: X\nrules:\n X => X+YF++YF-FX--FXFX-YF+\n Y => -FX+YFYF++YF+FX--FX-Y \n\nangle: 60`,\n\n`// Peano curve\naxiom: X\nrules: \n X => XFYFX-F-YFXFY+F+XFYFX\n Y => YFXFY+F+XFYFX-F-YFXFY\n\nangle: 90`,\n`// Square Sierpinski\naxiom: F+XF+F+XF\nrules: \n X => XF-F+F-XF+F+XF-F+F-X\n\ndepth: 4\nangle: 90\n`,\n`// Tree\naxiom: X\nrules: \n F => FF\n X => F-[[X]+X]+F[+FX]-X\n\ndirection: [0, 1, 0]\nangle: 22.5`,\n`// Hilbert curve\naxiom: X\nrules: \n X => -YF+XFX+FY-\n Y => +XF-YFY-FX+\n\nangle: 90`,\n\n`// blocks\naxiom: F+F+F+F\nrules: \n F => F-f+FF-FF-FF-FFf-FFFF\n f => ffffff\n\nangle: 90\ndepth: 3 `,\n`// 3 Blocks\naxiom: F^^F^^F\nrules: \n F => F-fff^F^^F^^F&&fff-FFF\n f => fff\n\ndepth: 3\nactions:\n - => rotate(-90)\n ^ => rotate(60)\n & => rotate(-60)\n`, `// Leaf\naxiom: Y---Y\nrules: \n X => F-FF-F--[--X]F-FF-F--F-FF-F--\n Y => f-F+X+F-fY\n\ndepth: 8\nangle: 60`, `// esum\naxiom: X+X+X+X+X+X+X+X\nrules: \n X => [F[-X++Y]]\n Y => [F[-Y--X]]\n F => F\n\ndepth: 6\nangle: -45`\n  ]\n\nexport default function getCodeModel(scene) {\n  let model = {\n    setCode,\n    error: null,\n    randomize,\n    code: qs.get('code')\n  }\n  let lastPickedIndex = -1;\n\n  setCode(model.code);\n\n  return model;\n\n  function randomize() {\n    let index;\n    do { index = pickRandomIndex(standardCollection) } while (index === lastPickedIndex);\n    lastPickedIndex = index;\n    let code = standardCollection[lastPickedIndex];\n    setCode(code);\n    model.ignoreNextUpdate = true;\n    model.code = code;\n  }\n\n  function setCode(newCode) {\n    newCode = newCode.trim();\n    if (!newCode) {\n      model.error = 'Enter a system description above'\n      return;\n    }\n    try {\n      let system = parseExpression(newCode);\n      if (system) {\n        // TODO: I messed up with grammar, and seems like string value takes precedence over\n        // axiom clause. A little hack here to put them back on the same page until better fix:\n        if (system.axiom) system.start = system.axiom;\n        scene.setSystem(system);\n        model.error = null;\n        qs.set('code', newCode);\n      } else {\n        model.error = 'Could not parse the input string';\n      }\n    } catch (e) {\n      model.error = e.message;\n    }\n  }\n}\n\nfunction getInitialCode() {\n  // todo: query state?\n  return `axiom: X\nrules: \n  X => -YF+XFX+FY-\n  Y => +XF-YFY-FX+\n\ndepth: 5\nstepsPerFrame: 10\nwidth: 2\ncolor: #FFFFFF\n\nactions:\n  - => rotate(-90)\n  + => rotate(90)\n  F => draw()\n`\n}\n\n\nfunction getRandomSystem(length) {\n  let states = 'FXY';\n  let res = [];\n  let lastCh = '';\n  while (res.length < length) {\n    let ch = pickChar();\n    if (ch === '+' && lastCh === '-') ch = '-'\n    else if (ch === '-' && lastCh === '+') ch = '+';\n    else if (ch === 'F' && lastCh === 'F') ch = Math.random() < 0.5 ? 'X': 'Y';\n    res.push(ch);\n    lastCh = ch;\n  }\n\n  for (let ch of 'FXY') {\n    if (res.indexOf(ch) < 0) {\n      res[Math.floor(Math.random() * res.length)] = ch;\n    }\n  }\n\n  let X = res.join('');\n  let Y = res.reverse().map( x => {\n    if (x === '+') return '-';\n    if (x === '-') return '+';\n    if (x === 'Y') return 'X';\n    if (x === 'X') return 'Y';\n    return x;\n  } ).join('')\n\n  let angle = Math.random() < 0.5 ? 60 : 90;\n  if (angle === 90 && ( X.match(/(\\+\\+|\\+-|--)/) || Y.match(/(\\+\\+|\\+-|--)/))) angle = 45;\n  return {X, Y, angle}\n\n  function pickChar() {\n    let r = Math.random();\n    if (r < 0.78) {\n      r = Math.random();\n      return states[Math.floor(states.length * r)]\n    } else {\n      return r < 0.89 ? '+' : '-'\n    }\n  }\n}\n\nfunction pickRandomIndex(arr) {\n  return Math.floor(Math.random() * arr.length);\n}","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('codemirror',{ref:\"editor\",attrs:{\"options\":{\n    viewportMargin: Infinity,\n    theme: 'lsystem',\n    mode: 'application/lsystem',\n  }},model:{value:(_vm.model.code),callback:function ($$v) {_vm.$set(_vm.model, \"code\", $$v)},expression:\"model.code\"}}),(_vm.model.error)?_c('div',{staticClass:\"error-container\"},[_c('pre',{staticClass:\"error hl\"},[_vm._v(_vm._s(_vm.model.error))])]):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import eventify from 'ngraph.events';\nconst bus = eventify({});\nexport default bus;","<template>\n<div>\n  <codemirror v-model='model.code' ref='editor' :options=\"{\n    viewportMargin: Infinity,\n    theme: 'lsystem',\n    mode: 'application/lsystem',\n  }\"></codemirror>\n  <div class='error-container' v-if='model.error'>\n    <pre class='error hl'>{{model.error}}</pre>\n  </div> \n</div>\n</template>\n\n<script>\nimport bus from './bus';\nimport { codemirror } from 'vue-codemirror-lite';\nvar CodeMirror = require('codemirror/lib/codemirror.js')\nrequire('codemirror/addon/comment/comment.js');\nrequire('./lmode.js')(CodeMirror)\n\nfunction toggleComment(cm) {\n  cm.toggleComment({\n    indent: true,\n    lineComment: '//'\n  });\n}\n\nfunction handleUp(cm) {\n  return updateValueIfNeededBy(1, cm);\n}\n\nfunction handleDown(cm) {\n  return updateValueIfNeededBy(-1, cm);\n}\n\nfunction updateValueIfNeededBy(delta, cm) {\n  let cursor = cm.getCursor();\n  let token = cm.getTokenAt(cursor);\n  if (!token || token.type !== 'number') return CodeMirror.Pass;\n\n  let from = {line: cursor.line, ch: token.start};\n  let end = {line: cursor.line, ch: token.end};\n\n  let v = Number.parseFloat(token.string);\n  let line = cm.getLine(cursor.line);\n  if (from.ch > 0) {\n    // minus is not part of the number.\n    if (line[from.ch - 1] === '-') {\n      v *= -1;\n      from.ch -= 1;\n    }\n  }\n\n  \n  v += delta;\n  var doc = cm.getDoc();\n  doc.replaceRange(String(v), from, end);\n  bus.fire('immediate-update')\n}\n//require('./glslmode')(CodeMirror);\nexport default {\n  name: 'CodeEditor',\n  props: ['model'],\n  components: {\n    codemirror\n  },\n\n  mounted() {\n    bus.on('settings-collapsed', refreshEditor, this);\n    bus.on('immediate-update', this.setImmediateUpdate, this);\n    this.$refs.editor.editor.setOption('extraKeys', {\n      'Cmd-/': toggleComment,\n      'Ctrl-/': toggleComment,\n      'Shift-Up': handleUp,\n      'Shift-Down': handleDown\n    });\n  },\n\n  beforeDestroy() {\n    bus.off('settings-collapsed', refreshEditor, this);\n    bus.off('immediate-update', this.setImmediateUpdate, this);\n  },\n  watch: {\n    'model.code': function() {\n      if (this.model.ignoreNextUpdate) {\n        this.model.ignoreNextUpdate = false;\n        return;\n      }\n      if (this.pendingSetCode) {\n        clearTimeout(this.pendingSetCode);\n      }\n      if (this.isImmediate) {\n        this.model.setCode(this.model.code);\n        this.pendingSetCode = 0;\n        return;\n      } \n\n      // We don't want to update code on each key stroke. This would have negative\n      // impact on performance.\n      this.pendingSetCode = setTimeout(() => {\n        this.model.setCode(this.model.code);\n        this.pendingSetCode = 0;\n      }, 300);\n    },\n  },\n  data() {\n    return {\n      clearImmediate: 0,\n      isImmediate: false\n    }\n  },\n  methods: {\n    setImmediateUpdate() {\n      if (this.clearImmediate) clearTimeout(this.clearImmediate);\n      this.clearImmediate = setTimeout(() => this.isImmediate = false, 30);\n      this.isImmediate = true;\n    }\n  }\n}\nfunction refreshEditor(isCollapsed) {\n  // Code mirror sometimes is not visible https://stackoverflow.com/questions/8349571/codemirror-editor-is-not-loading-content-until-clicked\n  if (!isCollapsed) {\n    setTimeout(() => {\n      this.$refs.editor.editor.refresh()\n    }, 10);\n  }\n}\n</script>","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./CodeEditor.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./CodeEditor.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./CodeEditor.vue?vue&type=template&id=e819de66&\"\nimport script from \"./CodeEditor.vue?vue&type=script&lang=js&\"\nexport * from \"./CodeEditor.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\n  <div id=\"app\">\n    <div class='sidebar'>\n      <div class='controls'>\n        <a href=\"#\" class='print-button' @click.prevent='toggleEdit'>{{ showEdit ? \"Hide editor\" : \"Edit...\"}}</a>\n        <a href=\"#\" class='try-another' @click.prevent='randomize'>Randomize</a>\n      </div>\n      <div v-if='showEdit' class='editor-container'>\n        <div class=\"section\">\n        <div class='title'>L-System details: <a class='reset-all' :class='{\"syntax-visible\": syntaxHelpVisible}' href='#' @click.prevent='syntaxHelpVisible = !syntaxHelpVisible' title='click to learn more about syntax'>syntax help</a></div>\n        <div class='help' v-if='syntaxHelpVisible'>\n          L-Systems are described very well on <a href='http://paulbourke.net/fractals/lsys/' target=\"_blank\">Paul Bourke's website</a>.\n          <p>The following is the list of available sections:\n            <ul>\n              <li><strong>axiom</strong>: initial state of the system</li>\n              <li><strong>rules</strong>: list of rewrite rules that are applied on each iteration</li>\n              <li><strong>depth</strong>: how deep we are allowed to go recursively</li>\n              <li><strong>angle</strong>: if specified, this argument governs rotation angle. Can be overridden with <strong>actions</strong></li>\n              <li><strong>actions</strong>: list of graphic commands that are triggered by a matching character in the evolved system.\n                The following is the list of available actions:\n                <ul>\n                  <li><strong>draw(x)</strong> draw <code>x</code> units in current direction</li>\n                  <li><strong>move(x)</strong> move <code>x</code> units in current direction without drawing</li>\n                  <li><strong>rotate(deg)</strong>  rotate current direction <code>deg</code> degrees around Z axis</li>\n                  <li><strong>rotateX(deg)</strong> rotate current direction <code>deg</code> degrees around X axis</li>\n                  <li><strong>rotateY(deg)</strong> rotate current direction <code>deg</code> degrees around Y axis</li>\n                  <li><strong>push()</strong> saves current render state onto stack</li>\n                  <li><strong>pop()</strong> restores previously saved render state</li>\n                </ul>\n                By default the following actions are added automatically:\n<pre><code>actions:\n  F => draw(10)\n  f => move(10)\n  + => rotate(60)\n  - => rotate(-60)\n  [ => push()\n  ] => pop()\n</code></pre>\n\n              </li>\n\n              <li><strong>width</strong>: width in pixels of the drawn line</li>\n              <li><strong>color</strong>: color of the line. Accepts names and hex. E.g. <code>blue</code>, works the same as <code>#0000ff</code></li>\n              <li><strong>stepsPerFrame</strong>: how many steps we are allowed to render per single frame.\n              If set to <code>-1</code> the scene is rendered immediately. This could be dangerous on deep\n              systems, as the entire system traversal may exhaust the browser's resources.\n              </li>\n\n              <li><strong>direction</strong>: three numbers separated by coma <code>x, y, z</code> that set initial direction</li>\n              <li><strong>position</strong>: three numbers separated by coma <code>x, y, z</code> that set initial position</li>\n            </ul>\n          </p>\n        </div>\n        <code-editor v-if='codeEditorModel' :model='codeEditorModel' class='code-editor-container'></code-editor>\n</div>\n        <div class='section border-top'>\n        <p>This website renders any L-Systems defined above. The website was created by <a href='https://twitter.com/anvaka'>@anvaka</a>.</p>\n        <p>You can find the entire source code <a href='https://github.com/anvaka/lsystem'>here</a>. \n        If you love this website you can also <a href='https://www.paypal.com/paypalme2/anvakos/3'>buy me a coffee</a>\n        </p>\n        <p>Finally, you can <a href='#' @click.prevent='toSVGFile' >export to svg</a> current scene</p>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport createScene from './createScene';\nimport getCodeModel from './getCodeModel';\nimport CodeEditor from './CodeEditor';\n\nexport default {\n  name: 'App',\n  components: {\n    CodeEditor\n  },\n  data() {\n    return {\n      codeEditorModel: null,\n      showEdit: true,\n      syntaxHelpVisible: false\n    }\n  },\n  mounted() {\n    this.scene = createScene(document.querySelector('#scene'));\n    this.codeEditorModel = getCodeModel(this.scene);\n  },\n  beforeDestroy() {\n    this.scene.dispose();\n  },\n  methods: {\n    toSVGFile() { \n      this.scene.saveToSVG('l-system.svg');\n    },\n    toggleEdit() {\n      this.showEdit = !this.showEdit;\n    },\n    randomize() {\n      this.codeEditorModel.randomize();\n    }\n  }\n\n}\n</script>\n\n<style lang='stylus'>\n@import \"./shared.styl\";\n@import \"./editor.styl\";\n\nhighlight-color = #172A4D;\nprimary-text = white;\nhelp-text-color = #267fcd;\nhelp-background = rgb(7, 12, 23);\n\nborder-color = #0d3f71;\n\n#app {\n  overflow: hidden;\n  max-height: 100%;\n  position: absolute;\n  z-index: 1;\n  color: #ffffff;\n  background: window-background;\n  box-shadow: 0 2px 4px rgba(0,0,0,0.2), 0 -1px 0px rgba(0,0,0,0.02);\n}\n\n.section {\n  padding: 8px;\n}\n.section.border-top {\n  border-top: 1px solid border-color;\n}\n.sidebar {\n  width: 500px;\n  overflow: hidden\n  max-height: 100%;\n}\n.editor-container {\n  max-height: calc(100vh - 68px);\n  overflow-y: scroll;\n  a {\n    color: #267fcd;\n    text-decoration: none;\n    border-bottom: 1px dashed #172a4d;\n  }\n}\n.error-container {\n  color: white;\n  background: #ff4500;\n  padding: 0 8px;\n}\n.title {\n  color: primary-text;\n  font-size: 18px;\n  padding-left: 4px;\n  a {\n    float: right;\n    font-size: 12px;\n    font-style: italic;\n    color: help-text-color;\n    height: 30px;\n    margin: -5px 0;\n    padding: 7px;\n    border-bottom: none;\n  }\n  a.syntax-visible {\n    background: help-background;\n    color: white;\n    font-style: normal;\n  }\n}\n\n.help {\n  margin-bottom: 7px;\n  padding: 14px;\n  background: #070c17;\n  color: #0774c3;\n  margin: 0 -8px 7px -8px;\n  a {\n    border-bottom: 1px dashed #172a4d;\n    color: white;\n  }\n  ul {\n    padding: 0\n    list-style-type: none;\n    \n    ul {\n      padding-left: 18px;\n      list-style-type: none;\n    }\n\n    strong {\n      color: white;\n      font-weight: normal;\n    }\n    code {\n      color: #4ec9b0;\n    }\n  }\n}\n.code-editor-container {\n  margin: 8px 0 16px 0;\n}\n\n.controls {\n  height: 48px;\n  display: flex;\n  flex-direction: row;\n  align-items: stretch;\n  justify-content: space-around;\n  border-bottom: 1px solid border-color;\n  a {\n    text-decoration: none;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    color: white;\n    margin: 0;\n    border: 0;\n    &:hover {\n      color: emphasis-background;\n      background: highlight-color;\n    }\n  }\n  a.try-another {\n    flex: 1;\n  }\n  a.print-button {\n    flex: 1;\n    border-right: 1px solid border-color;\n    &:focus {\n      border: 1px dashed highlight-color;\n    }\n  }\n}\n@media (max-width: 500px) {\n  #app {\n    width: 100%;\n    margin: 0;\n  }\n  .sidebar {\n    width: 100%;\n  }\n}\n</style>\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=4bbe95a0&\"\nimport script from \"./App.vue?vue&type=script&lang=js&\"\nexport * from \"./App.vue?vue&type=script&lang=js&\"\nimport style0 from \"./App.vue?vue&type=style&index=0&lang=stylus&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _vm._m(0)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"absolute no-webgl\"},[_c('h3',[_vm._v(\"WebGL is not enabled :(\")]),_c('p',[_vm._v(\" To render large amount of data fast, this website uses \"),_c('a',{attrs:{\"href\":\"https://get.webgl.org/\"}},[_vm._v(\"WebGL\")]),_vm._v(\", which seem to be not supported by the device that you are using. \")]),_c('p',[_vm._v(\"Please try a different device to play with this website\")])])}]\n\nexport { render, staticRenderFns }","import { render, staticRenderFns } from \"./NoWebGL.vue?vue&type=template&id=283309e6&scoped=true&\"\nvar script = {}\nimport style0 from \"./NoWebGL.vue?vue&type=style&index=0&id=283309e6&lang=stylus&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"283309e6\",\n  null\n  \n)\n\nexport default component.exports","import Vue from 'vue'\nimport App from './App.vue'\nimport NoWebGL from './NoWebGL';\nimport {isWebGLEnabled} from 'w-gl';\n\nVue.config.productionTip = false\n\nlet canRender = isWebGLEnabled(document.querySelector('#canvas'));\n\nnew Vue({\n  render: h => h(canRender ? App : NoWebGL),\n}).$mount('#app')\n","import mod from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../node_modules/stylus-loader/index.js??ref--11-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=stylus&\"; export default mod; export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../node_modules/stylus-loader/index.js??ref--11-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=stylus&\"","import mod from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../node_modules/stylus-loader/index.js??ref--11-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./NoWebGL.vue?vue&type=style&index=0&id=283309e6&lang=stylus&scoped=true&\"; export default mod; export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../node_modules/stylus-loader/index.js??ref--11-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./NoWebGL.vue?vue&type=style&index=0&id=283309e6&lang=stylus&scoped=true&\"","/* eslint-disable */\n\n// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n// Hacked together to barely support l-system definition\n// by Andrei Kashcha (anvaka@)\n\nmodule.exports = function(CodeMirror) {\n\"use strict\";\n\nCodeMirror.defineMode(\"javascript\", function(config, parserConfig) {\n  var indentUnit = config.indentUnit;\n  var statementIndent = parserConfig.statementIndent;\n  var jsonMode = parserConfig.json;\n  var lSystemMode = parserConfig.lsystem;\n  var isTS = parserConfig.typescript;\n  var wordRE = parserConfig.wordCharacters || /[\\w$\\xa1-\\uffff]/;\n  var ruleCharRE = /[a-zA-Z+_^?~|&*%\\][-]/;\n\n  // Tokenizer\n\n  var keywords = function(){\n    function kw(type) {return {type: type, style: \"keyword\"};}\n    var A = kw(\"keyword a\"), B = kw(\"keyword b\"), C = kw(\"keyword c\"), D = kw(\"keyword d\");\n    var operator = kw(\"operator\"), atom = {type: \"atom\", style: \"atom\"};\n\n    return {\n      axiom: kw('axiom'),\n      angle: kw('angle'),\n      start: kw('start'),\n      direction: kw('direction'),\n      position: kw('position'),\n      hideGrid: kw('hideGrid'),\n      rules: kw('rules'),\n      depth: kw('depth'),\n      stepsPerFrame: kw('stepsPerFrame'),\n      actions: kw('actions'),\n      color: kw('color'),\n      width: kw('width'),\n    };\n  }();\n  let nope = {test: () => false}\n\n  var isOperatorChar = nope; \n\n  function readRegexp(stream) {\n    var escaped = false, next, inSet = false;\n    while ((next = stream.next()) != null) {\n      if (!escaped) {\n        if (next == \"/\" && !inSet) return;\n        if (next == \"[\") inSet = true;\n        else if (inSet && next == \"]\") inSet = false;\n      }\n      escaped = !escaped && next == \"\\\\\";\n    }\n  }\n\n  // Used as scratch variables to communicate multiple values without\n  // consing up tons of objects.\n  var type, content;\n  function ret(tp, style, cont) {\n    type = tp; content = cont;\n    return style;\n  }\n  function tokenBase(stream, state) {\n    var ch = stream.next();\n    if (ch == '\"' || ch == \"'\") {\n      state.tokenize = tokenString(ch);\n      return state.tokenize(stream, state);\n    } else if (ch == \".\" && stream.match(/^\\d[\\d_]*(?:[eE][+\\-]?[\\d_]+)?/)) {\n      return ret(\"number\", \"number\");\n    } else if (ch == \".\" && stream.match(\"..\")) {\n      return ret(\"spread\", \"meta\");\n    } else if (/[{}\\(\\),;\\:\\.]/.test(ch)) {\n      return ret(ch);\n    } else if (ch == \"=\" && stream.eat(\">\")) {\n      return ret(\"=>\", \"operator\");\n    } else if (ch == \"0\" && stream.match(/^(?:x[\\dA-Fa-f_]+|o[0-7_]+|b[01_]+)n?/)) {\n      return ret(\"number\", \"number\");\n    } else if (/\\d/.test(ch)) {\n      stream.match(/^[\\d_]*(?:n|(?:\\.[\\d_]*)?(?:[eE][+\\-]?[\\d_]+)?)?/);\n      return ret(\"number\", \"number\");\n    } else if (ch == \"/\") {\n      if (stream.eat(\"*\")) {\n        state.tokenize = tokenComment;\n        return tokenComment(stream, state);\n      } else if (stream.eat(\"/\")) {\n        stream.skipToEnd();\n        return ret(\"comment\", \"comment\");\n      } else if (expressionAllowed(stream, state, 1)) {\n        readRegexp(stream);\n        stream.match(/^\\b(([gimyus])(?![gimyus]*\\2))+\\b/);\n        return ret(\"regexp\", \"string-2\");\n      } else {\n        stream.eat(\"=\");\n        return ret(\"operator\", \"operator\", stream.current());\n      }\n    } else if (ch == \"`\") {\n      state.tokenize = tokenQuasi;\n      return tokenQuasi(stream, state);\n    } else if (ch == \"#\" && stream.peek() == \"!\") {\n      stream.skipToEnd();\n      return ret(\"meta\", \"meta\");\n    } else if (ch == \"#\" && stream.eatWhile(wordRE)) {\n      return ret(\"variable\", \"property\")\n    } else if (ch == \"<\" && stream.match(\"!--\") || ch == \"-\" && stream.match(\"->\")) {\n      stream.skipToEnd()\n      return ret(\"comment\", \"comment\")\n    } else if (isOperatorChar.test(ch)) {\n      if (ch != \">\" || !state.lexical || state.lexical.type != \">\") {\n        if (stream.eat(\"=\")) {\n          if (ch == \"!\" || ch == \"=\") stream.eat(\"=\")\n        } else if (/[<>*+\\-]/.test(ch)) {\n          stream.eat(ch)\n          if (ch == \">\") stream.eat(ch)\n        }\n      }\n      if (ch == \"?\" && stream.eat(\".\")) return ret(\".\")\n      return ret(\"operator\", \"operator\", stream.current());\n    } else if (wordRE.test(ch)) {\n      stream.eatWhile(wordRE);\n      var word = stream.current()\n      if (state.lastType != \".\") {\n        if (keywords.propertyIsEnumerable(word)) {\n          var kw = keywords[word]\n          return ret(kw.type, kw.style, word)\n        }\n        if (word == \"async\" && stream.match(/^(\\s|\\/\\*.*?\\*\\/)*[\\[\\(\\w]/, false))\n          return ret(\"async\", \"keyword\", word)\n      }\n      return ret(\"variable\", \"variable\", word)\n    } else if (ruleCharRE.test(ch)) {\n      var arrow = stream.string.indexOf(\"=>\", stream.start);\n      if (arrow > -1) {\n        var word = stream.current()\n        return ret(\"def\", \"def\", word)\n      }\n    } \n  }\n\n  function tokenString(quote) {\n    return function(stream, state) {\n      var escaped = false, next;\n      while ((next = stream.next()) != null) {\n        if (next == quote && !escaped) break;\n        escaped = !escaped && next == \"\\\\\";\n      }\n      if (!escaped) state.tokenize = tokenBase;\n      return ret(\"string\", \"string\");\n    };\n  }\n\n  function tokenComment(stream, state) {\n    var maybeEnd = false, ch;\n    while (ch = stream.next()) {\n      if (ch == \"/\" && maybeEnd) {\n        state.tokenize = tokenBase;\n        break;\n      }\n      maybeEnd = (ch == \"*\");\n    }\n    return ret(\"comment\", \"comment\");\n  }\n\n  function tokenQuasi(stream, state) {\n    var escaped = false, next;\n    while ((next = stream.next()) != null) {\n      if (!escaped && (next == \"`\" || next == \"$\" && stream.eat(\"{\"))) {\n        state.tokenize = tokenBase;\n        break;\n      }\n      escaped = !escaped && next == \"\\\\\";\n    }\n    return ret(\"quasi\", \"string-2\", stream.current());\n  }\n\n  var brackets = \"([{}])\";\n  // This is a crude lookahead trick to try and notice that we're\n  // parsing the argument patterns for a fat-arrow function before we\n  // actually hit the arrow token. It only works if the arrow is on\n  // the same line as the arguments and there's no strange noise\n  // (comments) in between. Fallback is to only notice when we hit the\n  // arrow, and not declare the arguments as locals for the arrow\n  // body.\n  function findFatArrow(stream, state) {\n    if (state.fatArrowAt) state.fatArrowAt = null;\n    var arrow = stream.string.indexOf(\"=>\", stream.start);\n    if (arrow < 0) return;\n\n    if (isTS) { // Try to skip TypeScript return type declarations after the arguments\n      var m = /:\\s*(?:\\w+(?:<[^>]*>|\\[\\])?|\\{[^}]*\\})\\s*$/.exec(stream.string.slice(stream.start, arrow))\n      if (m) arrow = m.index\n    }\n\n    var depth = 0, sawSomething = false;\n    for (var pos = arrow - 1; pos >= 0; --pos) {\n      var ch = stream.string.charAt(pos);\n      var bracket = brackets.indexOf(ch);\n      if (bracket >= 0 && bracket < 3) {\n        if (!depth) { ++pos; break; }\n        if (--depth == 0) { if (ch == \"(\") sawSomething = true; break; }\n      } else if (bracket >= 3 && bracket < 6) {\n        ++depth;\n      } else if (wordRE.test(ch)) {\n        sawSomething = true;\n      } else if (/[\"'\\/`]/.test(ch)) {\n        for (;; --pos) {\n          if (pos == 0) return\n          var next = stream.string.charAt(pos - 1)\n          if (next == ch && stream.string.charAt(pos - 2) != \"\\\\\") { pos--; break }\n        }\n      } else if (sawSomething && !depth) {\n        ++pos;\n        break;\n      }\n    }\n    if (sawSomething && !depth) state.fatArrowAt = pos;\n  }\n\n  // Parser\n\n  var atomicTypes = {\"atom\": true, \"number\": true, \"variable\": true, \"string\": true, \"regexp\": true, \"this\": true, \"jsonld-keyword\": true};\n\n  function JSLexical(indented, column, type, align, prev, info) {\n    this.indented = indented;\n    this.column = column;\n    this.type = type;\n    this.prev = prev;\n    this.info = info;\n    if (align != null) this.align = align;\n  }\n\n  function inScope(state, varname) {\n    for (var v = state.localVars; v; v = v.next)\n      if (v.name == varname) return true;\n    for (var cx = state.context; cx; cx = cx.prev) {\n      for (var v = cx.vars; v; v = v.next)\n        if (v.name == varname) return true;\n    }\n  }\n\n  function parseJS(state, style, type, content, stream) {\n    var cc = state.cc;\n    // Communicate our context to the combinators.\n    // (Less wasteful than consing up a hundred closures on every call.)\n    cx.state = state; cx.stream = stream; cx.marked = null, cx.cc = cc; cx.style = style;\n\n    if (!state.lexical.hasOwnProperty(\"align\"))\n      state.lexical.align = true;\n\n    while(true) {\n      var combinator = cc.length ? cc.pop() : jsonMode ? expression : statement;\n      if (combinator(type, content)) {\n        while(cc.length && cc[cc.length - 1].lex)\n          cc.pop()();\n        if (cx.marked) return cx.marked;\n        if (type == \"variable\" && inScope(state, content)) return \"variable-2\";\n        return style;\n      }\n    }\n  }\n\n  // Combinator utils\n\n  var cx = {state: null, column: null, marked: null, cc: null};\n  function pass() {\n    for (var i = arguments.length - 1; i >= 0; i--) cx.cc.push(arguments[i]);\n  }\n  function cont() {\n    pass.apply(null, arguments);\n    return true;\n  }\n  function inList(name, list) {\n    for (var v = list; v; v = v.next) if (v.name == name) return true\n    return false;\n  }\n  function register(varname) {\n    var state = cx.state;\n    cx.marked = \"def\";\n    if (state.context) {\n      if (state.lexical.info == \"var\" && state.context && state.context.block) {\n        // FIXME function decls are also not block scoped\n        var newContext = registerVarScoped(varname, state.context)\n        if (newContext != null) {\n          state.context = newContext\n          return\n        }\n      } else if (!inList(varname, state.localVars)) {\n        state.localVars = new Var(varname, state.localVars)\n        return\n      }\n    }\n    // Fall through means this is global\n    if (parserConfig.globalVars && !inList(varname, state.globalVars))\n      state.globalVars = new Var(varname, state.globalVars)\n  }\n  function registerVarScoped(varname, context) {\n    if (!context) {\n      return null\n    } else if (context.block) {\n      var inner = registerVarScoped(varname, context.prev)\n      if (!inner) return null\n      if (inner == context.prev) return context\n      return new Context(inner, context.vars, true)\n    } else if (inList(varname, context.vars)) {\n      return context\n    } else {\n      return new Context(context.prev, new Var(varname, context.vars), false)\n    }\n  }\n\n  function isModifier(name) {\n    return name == \"public\" || name == \"private\" || name == \"protected\" || name == \"abstract\" || name == \"readonly\"\n  }\n\n  // Combinators\n\n  function Context(prev, vars, block) { this.prev = prev; this.vars = vars; this.block = block }\n  function Var(name, next) { this.name = name; this.next = next }\n\n  var defaultVars = new Var(\"this\", new Var(\"arguments\", null))\n  function pushcontext() {\n    cx.state.context = new Context(cx.state.context, cx.state.localVars, false)\n    cx.state.localVars = defaultVars\n  }\n  function pushblockcontext() {\n    cx.state.context = new Context(cx.state.context, cx.state.localVars, true)\n    cx.state.localVars = null\n  }\n  function popcontext() {\n    cx.state.localVars = cx.state.context.vars\n    cx.state.context = cx.state.context.prev\n  }\n  popcontext.lex = true\n  function pushlex(type, info) {\n    var result = function() {\n      var state = cx.state, indent = state.indented;\n      if (state.lexical.type == \"stat\") indent = state.lexical.indented;\n      else for (var outer = state.lexical; outer && outer.type == \")\" && outer.align; outer = outer.prev)\n        indent = outer.indented;\n      state.lexical = new JSLexical(indent, cx.stream.column(), type, null, state.lexical, info);\n    };\n    result.lex = true;\n    return result;\n  }\n  function poplex() {\n    var state = cx.state;\n    if (state.lexical.prev) {\n      if (state.lexical.type == \")\")\n        state.indented = state.lexical.indented;\n      state.lexical = state.lexical.prev;\n    }\n  }\n  poplex.lex = true;\n\n  function expect(wanted) {\n    function exp(type) {\n      if (type == wanted) return cont();\n      else if (wanted == \";\" || type == \"}\" || type == \")\" || type == \"]\") return pass();\n      else return cont(exp);\n    };\n    return exp;\n  }\n\n  function statement(type, value) {\n    if (type == \"var\") return cont(pushlex(\"vardef\", value), vardef, expect(\";\"), poplex);\n    if (type == \"keyword a\") return cont(pushlex(\"form\"), parenExpr, statement, poplex);\n    if (type == \"keyword b\") return cont(pushlex(\"form\"), statement, poplex);\n    if (type == \"keyword d\") return cx.stream.match(/^\\s*$/, false) ? cont() : cont(pushlex(\"stat\"), maybeexpression, expect(\";\"), poplex);\n    if (type == \"debugger\") return cont(expect(\";\"));\n    if (type == \"{\") return cont(pushlex(\"}\"), pushblockcontext, block, poplex, popcontext);\n    if (type == \";\") return cont();\n    if (type == \"if\") {\n      if (cx.state.lexical.info == \"else\" && cx.state.cc[cx.state.cc.length - 1] == poplex)\n        cx.state.cc.pop()();\n      return cont(pushlex(\"form\"), parenExpr, statement, poplex, maybeelse);\n    }\n    if (type == \"function\") return cont(functiondef);\n    if (type == \"for\") return cont(pushlex(\"form\"), forspec, statement, poplex);\n    if (type == \"class\" || (isTS && value == \"interface\")) {\n      cx.marked = \"keyword\"\n      return cont(pushlex(\"form\", type == \"class\" ? type : value), className, poplex)\n    }\n    if (type == \"variable\") {\n      if (isTS && value == \"declare\") {\n        cx.marked = \"keyword\"\n        return cont(statement)\n      } else if (isTS && (value == \"module\" || value == \"enum\" || value == \"type\") && cx.stream.match(/^\\s*\\w/, false)) {\n        cx.marked = \"keyword\"\n        if (value == \"enum\") return cont(enumdef);\n        else if (value == \"type\") return cont(typename, expect(\"operator\"), typeexpr, expect(\";\"));\n        else return cont(pushlex(\"form\"), pattern, expect(\"{\"), pushlex(\"}\"), block, poplex, poplex)\n      } else if (isTS && value == \"namespace\") {\n        cx.marked = \"keyword\"\n        return cont(pushlex(\"form\"), expression, statement, poplex)\n      } else if (isTS && value == \"abstract\") {\n        cx.marked = \"keyword\"\n        return cont(statement)\n      } else {\n        return cont(pushlex(\"stat\"), maybelabel);\n      }\n    }\n    if (type == \"switch\") return cont(pushlex(\"form\"), parenExpr, expect(\"{\"), pushlex(\"}\", \"switch\"), pushblockcontext,\n                                      block, poplex, poplex, popcontext);\n    if (type == \"case\") return cont(expression, expect(\":\"));\n    if (type == \"default\") return cont(expect(\":\"));\n    if (type == \"catch\") return cont(pushlex(\"form\"), pushcontext, maybeCatchBinding, statement, poplex, popcontext);\n    if (type == \"export\") return cont(pushlex(\"stat\"), afterExport, poplex);\n    if (type == \"import\") return cont(pushlex(\"stat\"), afterImport, poplex);\n    if (type == \"async\") return cont(statement)\n    if (value == \"@\") return cont(expression, statement)\n    return pass(pushlex(\"stat\"), expression, expect(\";\"), poplex);\n  }\n  function maybeCatchBinding(type) {\n    if (type == \"(\") return cont(funarg, expect(\")\"))\n  }\n  function expression(type, value) {\n    return expressionInner(type, value, false);\n  }\n  function expressionNoComma(type, value) {\n    return expressionInner(type, value, true);\n  }\n  function parenExpr(type) {\n    if (type != \"(\") return pass()\n    return cont(pushlex(\")\"), maybeexpression, expect(\")\"), poplex)\n  }\n  function expressionInner(type, value, noComma) {\n    if (cx.state.fatArrowAt == cx.stream.start) {\n      var body = noComma ? arrowBodyNoComma : arrowBody;\n      if (type == \"(\") return cont(pushcontext, pushlex(\")\"), commasep(funarg, \")\"), poplex, expect(\"=>\"), body, popcontext);\n      else if (type == \"variable\") return pass(pushcontext, pattern, expect(\"=>\"), body, popcontext);\n    }\n\n    var maybeop = noComma ? maybeoperatorNoComma : maybeoperatorComma;\n    if (atomicTypes.hasOwnProperty(type)) return cont(maybeop);\n    if (type == \"function\") return cont(functiondef, maybeop);\n    if (type == \"class\" || (isTS && value == \"interface\")) { cx.marked = \"keyword\"; return cont(pushlex(\"form\"), classExpression, poplex); }\n    if (type == \"keyword c\" || type == \"async\") return cont(noComma ? expressionNoComma : expression);\n    if (type == \"(\") return cont(pushlex(\")\"), maybeexpression, expect(\")\"), poplex, maybeop);\n    if (type == \"operator\" || type == \"spread\") return cont(noComma ? expressionNoComma : expression);\n    if (type == \"[\") return cont(pushlex(\"]\"), arrayLiteral, poplex, maybeop);\n    if (type == \"{\") return contCommasep(objprop, \"}\", null, maybeop);\n    if (type == \"quasi\") return pass(quasi, maybeop);\n    if (type == \"new\") return cont(maybeTarget(noComma));\n    if (type == \"import\") return cont(expression);\n    return cont();\n  }\n  function maybeexpression(type) {\n    if (type.match(/[;\\}\\)\\],]/)) return pass();\n    return pass(expression);\n  }\n\n  function maybeoperatorComma(type, value) {\n    if (type == \",\") return cont(maybeexpression);\n    return maybeoperatorNoComma(type, value, false);\n  }\n  function maybeoperatorNoComma(type, value, noComma) {\n    var me = noComma == false ? maybeoperatorComma : maybeoperatorNoComma;\n    var expr = noComma == false ? expression : expressionNoComma;\n    if (type == \"=>\") return cont(pushcontext, noComma ? arrowBodyNoComma : arrowBody, popcontext);\n    if (type == \"operator\") {\n      if (/\\+\\+|--/.test(value) || isTS && value == \"!\") return cont(me);\n      if (isTS && value == \"<\" && cx.stream.match(/^([^<>]|<[^<>]*>)*>\\s*\\(/, false))\n        return cont(pushlex(\">\"), commasep(typeexpr, \">\"), poplex, me);\n      if (value == \"?\") return cont(expression, expect(\":\"), expr);\n      return cont(expr);\n    }\n    if (type == \"quasi\") { return pass(quasi, me); }\n    if (type == \";\") return;\n    if (type == \"(\") return contCommasep(expressionNoComma, \")\", \"call\", me);\n    if (type == \".\") return cont(property, me);\n    if (type == \"[\") return cont(pushlex(\"]\"), maybeexpression, expect(\"]\"), poplex, me);\n    if (isTS && value == \"as\") { cx.marked = \"keyword\"; return cont(typeexpr, me) }\n    if (type == \"regexp\") {\n      cx.state.lastType = cx.marked = \"operator\"\n      cx.stream.backUp(cx.stream.pos - cx.stream.start - 1)\n      return cont(expr)\n    }\n  }\n  function quasi(type, value) {\n    if (type != \"quasi\") return pass();\n    if (value.slice(value.length - 2) != \"${\") return cont(quasi);\n    return cont(expression, continueQuasi);\n  }\n  function continueQuasi(type) {\n    if (type == \"}\") {\n      cx.marked = \"string-2\";\n      cx.state.tokenize = tokenQuasi;\n      return cont(quasi);\n    }\n  }\n  function arrowBody(type) {\n    findFatArrow(cx.stream, cx.state);\n    return pass(type == \"{\" ? statement : expression);\n  }\n  function arrowBodyNoComma(type) {\n    findFatArrow(cx.stream, cx.state);\n    return pass(type == \"{\" ? statement : expressionNoComma);\n  }\n  function maybeTarget(noComma) {\n    return function(type) {\n      if (type == \".\") return cont(noComma ? targetNoComma : target);\n      else if (type == \"variable\" && isTS) return cont(maybeTypeArgs, noComma ? maybeoperatorNoComma : maybeoperatorComma)\n      else return pass(noComma ? expressionNoComma : expression);\n    };\n  }\n  function target(_, value) {\n    if (value == \"target\") { cx.marked = \"keyword\"; return cont(maybeoperatorComma); }\n  }\n  function targetNoComma(_, value) {\n    if (value == \"target\") { cx.marked = \"keyword\"; return cont(maybeoperatorNoComma); }\n  }\n  function maybelabel(type) {\n    if (type == \":\") return cont(poplex, statement);\n    return pass(maybeoperatorComma, expect(\";\"), poplex);\n  }\n  function property(type) {\n    if (type == \"variable\") {cx.marked = \"property\"; return cont();}\n  }\n  function objprop(type, value) {\n    if (type == \"async\") {\n      cx.marked = \"property\";\n      return cont(objprop);\n    } else if (type == \"variable\" || cx.style == \"keyword\") {\n      cx.marked = \"property\";\n      if (value == \"get\" || value == \"set\") return cont(getterSetter);\n      var m // Work around fat-arrow-detection complication for detecting typescript typed arrow params\n      if (isTS && cx.state.fatArrowAt == cx.stream.start && (m = cx.stream.match(/^\\s*:\\s*/, false)))\n        cx.state.fatArrowAt = cx.stream.pos + m[0].length\n      return cont(afterprop);\n    } else if (type == \"number\" || type == \"string\") {\n      cx.marked = (cx.style + \" property\");\n      return cont(afterprop);\n    } else if (type == \"jsonld-keyword\") {\n      return cont(afterprop);\n    } else if (isTS && isModifier(value)) {\n      cx.marked = \"keyword\"\n      return cont(objprop)\n    } else if (type == \"[\") {\n      return cont(expression, maybetype, expect(\"]\"), afterprop);\n    } else if (type == \"spread\") {\n      return cont(expressionNoComma, afterprop);\n    } else if (value == \"*\") {\n      cx.marked = \"keyword\";\n      return cont(objprop);\n    } else if (type == \":\") {\n      return pass(afterprop)\n    }\n  }\n  function getterSetter(type) {\n    if (type != \"variable\") return pass(afterprop);\n    cx.marked = \"property\";\n    return cont(functiondef);\n  }\n  function afterprop(type) {\n    if (type == \":\") return cont(expressionNoComma);\n    if (type == \"(\") return pass(functiondef);\n  }\n  function commasep(what, end, sep) {\n    function proceed(type, value) {\n      if (sep ? sep.indexOf(type) > -1 : type == \",\") {\n        var lex = cx.state.lexical;\n        if (lex.info == \"call\") lex.pos = (lex.pos || 0) + 1;\n        return cont(function(type, value) {\n          if (type == end || value == end) return pass()\n          return pass(what)\n        }, proceed);\n      }\n      if (type == end || value == end) return cont();\n      if (sep && sep.indexOf(\";\") > -1) return pass(what)\n      return cont(expect(end));\n    }\n    return function(type, value) {\n      if (type == end || value == end) return cont();\n      return pass(what, proceed);\n    };\n  }\n  function contCommasep(what, end, info) {\n    for (var i = 3; i < arguments.length; i++)\n      cx.cc.push(arguments[i]);\n    return cont(pushlex(end, info), commasep(what, end), poplex);\n  }\n  function block(type) {\n    if (type == \"}\") return cont();\n    return pass(statement, block);\n  }\n  function maybetype(type, value) {\n    if (isTS) {\n      if (type == \":\") return cont(typeexpr);\n      if (value == \"?\") return cont(maybetype);\n    }\n  }\n  function maybetypeOrIn(type, value) {\n    if (isTS && (type == \":\" || value == \"in\")) return cont(typeexpr)\n  }\n  function mayberettype(type) {\n    if (isTS && type == \":\") {\n      if (cx.stream.match(/^\\s*\\w+\\s+is\\b/, false)) return cont(expression, isKW, typeexpr)\n      else return cont(typeexpr)\n    }\n  }\n  function isKW(_, value) {\n    if (value == \"is\") {\n      cx.marked = \"keyword\"\n      return cont()\n    }\n  }\n  function typeexpr(type, value) {\n    if (value == \"keyof\" || value == \"typeof\" || value == \"infer\") {\n      cx.marked = \"keyword\"\n      return cont(value == \"typeof\" ? expressionNoComma : typeexpr)\n    }\n    if (type == \"variable\" || value == \"void\") {\n      cx.marked = \"type\"\n      return cont(afterType)\n    }\n    if (value == \"|\" || value == \"&\") return cont(typeexpr)\n    if (type == \"string\" || type == \"number\" || type == \"atom\") return cont(afterType);\n    if (type == \"[\") return cont(pushlex(\"]\"), commasep(typeexpr, \"]\", \",\"), poplex, afterType)\n    if (type == \"{\") return cont(pushlex(\"}\"), commasep(typeprop, \"}\", \",;\"), poplex, afterType)\n    if (type == \"(\") return cont(commasep(typearg, \")\"), maybeReturnType, afterType)\n    if (type == \"<\") return cont(commasep(typeexpr, \">\"), typeexpr)\n  }\n  function maybeReturnType(type) {\n    if (type == \"=>\") return cont(typeexpr)\n  }\n  function typeprop(type, value) {\n    if (type == \"variable\" || cx.style == \"keyword\") {\n      cx.marked = \"property\"\n      return cont(typeprop)\n    } else if (value == \"?\" || type == \"number\" || type == \"string\") {\n      return cont(typeprop)\n    } else if (type == \":\") {\n      return cont(typeexpr)\n    } else if (type == \"[\") {\n      return cont(expect(\"variable\"), maybetypeOrIn, expect(\"]\"), typeprop)\n    } else if (type == \"(\") {\n      return pass(functiondecl, typeprop)\n    }\n  }\n  function typearg(type, value) {\n    if (type == \"variable\" && cx.stream.match(/^\\s*[?:]/, false) || value == \"?\") return cont(typearg)\n    if (type == \":\") return cont(typeexpr)\n    if (type == \"spread\") return cont(typearg)\n    return pass(typeexpr)\n  }\n  function afterType(type, value) {\n    if (value == \"<\") return cont(pushlex(\">\"), commasep(typeexpr, \">\"), poplex, afterType)\n    if (value == \"|\" || type == \".\" || value == \"&\") return cont(typeexpr)\n    if (type == \"[\") return cont(typeexpr, expect(\"]\"), afterType)\n    if (value == \"extends\" || value == \"implements\") { cx.marked = \"keyword\"; return cont(typeexpr) }\n    if (value == \"?\") return cont(typeexpr, expect(\":\"), typeexpr)\n  }\n  function maybeTypeArgs(_, value) {\n    if (value == \"<\") return cont(pushlex(\">\"), commasep(typeexpr, \">\"), poplex, afterType)\n  }\n  function typeparam() {\n    return pass(typeexpr, maybeTypeDefault)\n  }\n  function maybeTypeDefault(_, value) {\n    if (value == \"=\") return cont(typeexpr)\n  }\n  function vardef(_, value) {\n    if (value == \"enum\") {cx.marked = \"keyword\"; return cont(enumdef)}\n    return pass(pattern, maybetype, maybeAssign, vardefCont);\n  }\n  function pattern(type, value) {\n    if (isTS && isModifier(value)) { cx.marked = \"keyword\"; return cont(pattern) }\n    if (type == \"variable\") { register(value); return cont(); }\n    if (type == \"spread\") return cont(pattern);\n    if (type == \"[\") return contCommasep(eltpattern, \"]\");\n    if (type == \"{\") return contCommasep(proppattern, \"}\");\n  }\n  function proppattern(type, value) {\n    if (type == \"variable\" && !cx.stream.match(/^\\s*:/, false)) {\n      register(value);\n      return cont(maybeAssign);\n    }\n    if (type == \"variable\") cx.marked = \"property\";\n    if (type == \"spread\") return cont(pattern);\n    if (type == \"}\") return pass();\n    if (type == \"[\") return cont(expression, expect(']'), expect(':'), proppattern);\n    return cont(expect(\":\"), pattern, maybeAssign);\n  }\n  function eltpattern() {\n    return pass(pattern, maybeAssign)\n  }\n  function maybeAssign(_type, value) {\n    if (value == \"=\") return cont(expressionNoComma);\n  }\n  function vardefCont(type) {\n    if (type == \",\") return cont(vardef);\n  }\n  function maybeelse(type, value) {\n    if (type == \"keyword b\" && value == \"else\") return cont(pushlex(\"form\", \"else\"), statement, poplex);\n  }\n  function forspec(type, value) {\n    if (value == \"await\") return cont(forspec);\n    if (type == \"(\") return cont(pushlex(\")\"), forspec1, poplex);\n  }\n  function forspec1(type) {\n    if (type == \"var\") return cont(vardef, forspec2);\n    if (type == \"variable\") return cont(forspec2);\n    return pass(forspec2)\n  }\n  function forspec2(type, value) {\n    if (type == \")\") return cont()\n    if (type == \";\") return cont(forspec2)\n    if (value == \"in\" || value == \"of\") { cx.marked = \"keyword\"; return cont(expression, forspec2) }\n    return pass(expression, forspec2)\n  }\n  function functiondef(type, value) {\n    if (value == \"*\") {cx.marked = \"keyword\"; return cont(functiondef);}\n    if (type == \"variable\") {register(value); return cont(functiondef);}\n    if (type == \"(\") return cont(pushcontext, pushlex(\")\"), commasep(funarg, \")\"), poplex, mayberettype, statement, popcontext);\n    if (isTS && value == \"<\") return cont(pushlex(\">\"), commasep(typeparam, \">\"), poplex, functiondef)\n  }\n  function functiondecl(type, value) {\n    if (value == \"*\") {cx.marked = \"keyword\"; return cont(functiondecl);}\n    if (type == \"variable\") {register(value); return cont(functiondecl);}\n    if (type == \"(\") return cont(pushcontext, pushlex(\")\"), commasep(funarg, \")\"), poplex, mayberettype, popcontext);\n    if (isTS && value == \"<\") return cont(pushlex(\">\"), commasep(typeparam, \">\"), poplex, functiondecl)\n  }\n  function typename(type, value) {\n    if (type == \"keyword\" || type == \"variable\") {\n      cx.marked = \"type\"\n      return cont(typename)\n    } else if (value == \"<\") {\n      return cont(pushlex(\">\"), commasep(typeparam, \">\"), poplex)\n    }\n  }\n  function funarg(type, value) {\n    if (value == \"@\") cont(expression, funarg)\n    if (type == \"spread\") return cont(funarg);\n    if (isTS && isModifier(value)) { cx.marked = \"keyword\"; return cont(funarg); }\n    if (isTS && type == \"this\") return cont(maybetype, maybeAssign)\n    return pass(pattern, maybetype, maybeAssign);\n  }\n  function classExpression(type, value) {\n    // Class expressions may have an optional name.\n    if (type == \"variable\") return className(type, value);\n    return classNameAfter(type, value);\n  }\n  function className(type, value) {\n    if (type == \"variable\") {register(value); return cont(classNameAfter);}\n  }\n  function classNameAfter(type, value) {\n    if (value == \"<\") return cont(pushlex(\">\"), commasep(typeparam, \">\"), poplex, classNameAfter)\n    if (value == \"extends\" || value == \"implements\" || (isTS && type == \",\")) {\n      if (value == \"implements\") cx.marked = \"keyword\";\n      return cont(isTS ? typeexpr : expression, classNameAfter);\n    }\n    if (type == \"{\") return cont(pushlex(\"}\"), classBody, poplex);\n  }\n  function classBody(type, value) {\n    if (type == \"async\" ||\n        (type == \"variable\" &&\n         (value == \"static\" || value == \"get\" || value == \"set\" || (isTS && isModifier(value))) &&\n         cx.stream.match(/^\\s+[\\w$\\xa1-\\uffff]/, false))) {\n      cx.marked = \"keyword\";\n      return cont(classBody);\n    }\n    if (type == \"variable\" || cx.style == \"keyword\") {\n      cx.marked = \"property\";\n      return cont(classfield, classBody);\n    }\n    if (type == \"number\" || type == \"string\") return cont(classfield, classBody);\n    if (type == \"[\")\n      return cont(expression, maybetype, expect(\"]\"), classfield, classBody)\n    if (value == \"*\") {\n      cx.marked = \"keyword\";\n      return cont(classBody);\n    }\n    if (isTS && type == \"(\") return pass(functiondecl, classBody)\n    if (type == \";\" || type == \",\") return cont(classBody);\n    if (type == \"}\") return cont();\n    if (value == \"@\") return cont(expression, classBody)\n  }\n  function classfield(type, value) {\n    if (value == \"?\") return cont(classfield)\n    if (type == \":\") return cont(typeexpr, maybeAssign)\n    if (value == \"=\") return cont(expressionNoComma)\n    var context = cx.state.lexical.prev, isInterface = context && context.info == \"interface\"\n    return pass(isInterface ? functiondecl : functiondef)\n  }\n  function afterExport(type, value) {\n    if (value == \"*\") { cx.marked = \"keyword\"; return cont(maybeFrom, expect(\";\")); }\n    if (value == \"default\") { cx.marked = \"keyword\"; return cont(expression, expect(\";\")); }\n    if (type == \"{\") return cont(commasep(exportField, \"}\"), maybeFrom, expect(\";\"));\n    return pass(statement);\n  }\n  function exportField(type, value) {\n    if (value == \"as\") { cx.marked = \"keyword\"; return cont(expect(\"variable\")); }\n    if (type == \"variable\") return pass(expressionNoComma, exportField);\n  }\n  function afterImport(type) {\n    if (type == \"string\") return cont();\n    if (type == \"(\") return pass(expression);\n    return pass(importSpec, maybeMoreImports, maybeFrom);\n  }\n  function importSpec(type, value) {\n    if (type == \"{\") return contCommasep(importSpec, \"}\");\n    if (type == \"variable\") register(value);\n    if (value == \"*\") cx.marked = \"keyword\";\n    return cont(maybeAs);\n  }\n  function maybeMoreImports(type) {\n    if (type == \",\") return cont(importSpec, maybeMoreImports)\n  }\n  function maybeAs(_type, value) {\n    if (value == \"as\") { cx.marked = \"keyword\"; return cont(importSpec); }\n  }\n  function maybeFrom(_type, value) {\n    if (value == \"from\") { cx.marked = \"keyword\"; return cont(expression); }\n  }\n  function arrayLiteral(type) {\n    if (type == \"]\") return cont();\n    return pass(commasep(expressionNoComma, \"]\"));\n  }\n  function enumdef() {\n    return pass(pushlex(\"form\"), pattern, expect(\"{\"), pushlex(\"}\"), commasep(enummember, \"}\"), poplex, poplex)\n  }\n  function enummember() {\n    return pass(pattern, maybeAssign);\n  }\n\n  function isContinuedStatement(state, textAfter) {\n    return state.lastType == \"operator\" || state.lastType == \",\" ||\n      isOperatorChar.test(textAfter.charAt(0)) ||\n      /[,.]/.test(textAfter.charAt(0));\n  }\n\n  function expressionAllowed(stream, state, backUp) {\n    return state.tokenize == tokenBase &&\n      /^(?:operator|sof|keyword [bcd]|case|new|export|default|spread|[\\[{}\\(,;:]|=>)$/.test(state.lastType) ||\n      (state.lastType == \"quasi\" && /\\{\\s*$/.test(stream.string.slice(0, stream.pos - (backUp || 0))))\n  }\n\n  // Interface\n\n  return {\n    startState: function(basecolumn) {\n      var state = {\n        tokenize: tokenBase,\n        lastType: \"sof\",\n        cc: [],\n        lexical: new JSLexical((basecolumn || 0) - indentUnit, 0, \"block\", false),\n        localVars: parserConfig.localVars,\n        context: parserConfig.localVars && new Context(null, null, false),\n        indented: basecolumn || 0\n      };\n      if (parserConfig.globalVars && typeof parserConfig.globalVars == \"object\")\n        state.globalVars = parserConfig.globalVars;\n      return state;\n    },\n\n    token: function(stream, state) {\n      if (stream.sol()) {\n        if (!state.lexical.hasOwnProperty(\"align\"))\n          state.lexical.align = false;\n        state.indented = stream.indentation();\n        findFatArrow(stream, state);\n      }\n      if (state.tokenize != tokenComment && stream.eatSpace()) return null;\n      var style = state.tokenize(stream, state);\n      if (type == \"comment\") return style;\n      state.lastType = type == \"operator\" && (content == \"++\" || content == \"--\") ? \"incdec\" : type;\n      return parseJS(state, style, type, content, stream);\n    },\n\n    indent: function(state, textAfter) {\n      if (state.tokenize == tokenComment) return CodeMirror.Pass;\n      if (state.tokenize != tokenBase) return 0;\n      var firstChar = textAfter && textAfter.charAt(0), lexical = state.lexical, top\n      // Kludge to prevent 'maybelse' from blocking lexical scope pops\n      if (!/^\\s*else\\b/.test(textAfter)) for (var i = state.cc.length - 1; i >= 0; --i) {\n        var c = state.cc[i];\n        if (c == poplex) lexical = lexical.prev;\n        else if (c != maybeelse) break;\n      }\n      while ((lexical.type == \"stat\" || lexical.type == \"form\") &&\n             (firstChar == \"}\" || ((top = state.cc[state.cc.length - 1]) &&\n                                   (top == maybeoperatorComma || top == maybeoperatorNoComma) &&\n                                   !/^[,\\.=+\\-*:?[\\(]/.test(textAfter))))\n        lexical = lexical.prev;\n      if (statementIndent && lexical.type == \")\" && lexical.prev.type == \"stat\")\n        lexical = lexical.prev;\n      var type = lexical.type, closing = firstChar == type;\n\n      if (type == \"vardef\") return lexical.indented + (state.lastType == \"operator\" || state.lastType == \",\" ? lexical.info.length + 1 : 0);\n      else if (type == \"form\" && firstChar == \"{\") return lexical.indented;\n      else if (type == \"form\") return lexical.indented + indentUnit;\n      else if (type == \"stat\")\n        return lexical.indented + (isContinuedStatement(state, textAfter) ? statementIndent || indentUnit : 0);\n      else if (lexical.info == \"switch\" && !closing && parserConfig.doubleIndentSwitch != false)\n        return lexical.indented + (/^(?:case|default)\\b/.test(textAfter) ? indentUnit : 2 * indentUnit);\n      else if (lexical.align) return lexical.column + (closing ? 0 : 1);\n      else return lexical.indented + (closing ? 0 : indentUnit);\n    },\n\n    electricInput: /^\\s*(?:case .*?:|default:|\\{|\\})$/,\n    blockCommentStart: jsonMode ? null : \"/*\",\n    blockCommentEnd: jsonMode ? null : \"*/\",\n    blockCommentContinue: jsonMode ? null : \" * \",\n    lineComment: jsonMode ? null : \"//\",\n    fold: \"brace\",\n    closeBrackets: \"()[]{}''\\\"\\\"``\",\n\n    helperType: jsonMode ? \"json\" : \"javascript\",\n    jsonldMode: false,\n    jsonMode: jsonMode,\n\n    expressionAllowed: expressionAllowed,\n\n    skipExpression: function(state) {\n      var top = state.cc[state.cc.length - 1]\n      if (top == expression || top == expressionNoComma) state.cc.pop()\n    }\n  };\n});\n\nCodeMirror.registerHelper(\"wordChars\", \"javascript\", /[\\w$]/);\n\nCodeMirror.defineMIME(\"text/javascript\", \"javascript\");\nCodeMirror.defineMIME(\"text/ecmascript\", \"javascript\");\nCodeMirror.defineMIME(\"application/javascript\", \"javascript\");\nCodeMirror.defineMIME(\"application/x-javascript\", \"javascript\");\nCodeMirror.defineMIME(\"application/ecmascript\", \"javascript\");\nCodeMirror.defineMIME(\"application/json\", {name: \"javascript\", json: true});\nCodeMirror.defineMIME(\"application/lsystem\", {name: \"javascript\", json: true, lsystem: true});\nCodeMirror.defineMIME(\"application/x-json\", {name: \"javascript\", json: true});\nCodeMirror.defineMIME(\"application/ld+json\", {name: \"javascript\", jsonld: true});\nCodeMirror.defineMIME(\"text/typescript\", { name: \"javascript\", typescript: true });\nCodeMirror.defineMIME(\"application/typescript\", { name: \"javascript\", typescript: true });\n}"],"sourceRoot":""}